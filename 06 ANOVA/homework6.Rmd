## Homework 6

<!--
Set the working directory.
No Rchunk is needed to accomplish this.
-->

<!--
Read in the homework6.csv data. For each of the following steps you
should preface your R commands with some plain English explanation.
The fabricated data are supposed to approximate how people perform
in different types of visual searches. Specifically, we're 
comparing performance in feature searches (e.g. looking for a red
X among green Xs) and conjunction searches (e.g. looking for a red
X among green Xs and red Os). We're also looking at how the number
of distractors within the search display effect our data.
-->
First I'm going to need the ggplot2, gplots, and dplyr packages for this assignment, so lI am going to load them up ???rst. Then set my working directory.
```{r}
library(ggplot2)
library(gplots)
library(dplyr)
```
Then I am going to read in the data.
```{r}
dat<-read.csv("homework6.csv")
```

<!--
Check the structure of the data and change any variables that should
be factor variables into factor variables
-->
The next step is to check out the structure
```{r}
str(dat)
```
From the structure we can see that distractors, subject, and subject2 should all be factor variables. So I'll fix that.

```{r}
dat$distractors<-as.factor(dat$distractors)
dat$subject<-as.factor(dat$subject)
dat$subject2<-as.factor(dat$subject2)
```
<!--
Perform a one-way between-subjects ANOVA examining for effects of 
the the number of distractors for the conjunction searches only.
Also create a line graph to help you interpret the results of your
analysis.
-->
First I need to get only the data from the conjunction searches.
```{r}
temp<-dat[dat$type=="conjunction",]
```
Now I will run the ANOVA.
```{r}
summary(aov(rt~distractors, data=temp))
```
There's a significant effect which show: F(2,21) =8.6, p < .05. To interpret these data better,
I'll create a line graph that shows the rt recalled for the various list distractors when participants are distracted.
```{r}

temp<-temp%>%group_by(distractors)%>%
  summarize(means=mean(rt),
            sems=sd(rt)/sqrt(length(rt)))

f<-ggplot(temp, aes(x=as.factor(distractors),
                    y=means,
                    group=1))+
  geom_line(size=1)+
  geom_point(size=2)+
  geom_errorbar(aes(ymax=means+sems,
                    ymin=means-sems),
                width=.2)+
  ggtitle("Serial distractors Effect")+
  labs(x="List distractors",y="rt Recalled")+
  theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
  theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
  theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
  theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
  theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
  coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),
                         max(temp$means)+2*max(temp$sems)))+
  theme(panel.border=element_blank(),axis.line=element_line())+
  theme(panel.grid.major.x=element_blank())+
  theme(panel.grid.major.y=element_line(color="darkgrey"))+
  theme(panel.grid.minor.y=element_blank())
f
```
From the figure we can see that participants do the best on the words that occur later on the list and worst on the words that occur in the beginning of the list.
<!--
Perform a one-way within subjects ANOVA on the same data you analyzed
earlier. Tip: use subject as the subjects variable for this analysis.
-->
Because I changed temp, I don't have the same data I analyzed last time, so I'm going to reuse the code I first used to create temp so I can perform the appropriate analysis.
```{r}
temp<-dat[dat$type=="conjunction",]
```
Now I'll perform the within-subjects analysis.

```{r}
summary(aov(rt~distractors+
              Error(subject/distractors),data=temp))
```
Participants performed better on earlier list positions than they did on later list positions, F(2,14) = 56.5, p = .05.
<!--
Perform a between-subjects ANOVA examining for the effects of and
interactions between the number of distractors and the search type.
Make sure to interpret your results.
-->
Now, I'll perform a between-subjects 2-way ANOVA
```{r}
summary(aov(rt~distractors*type, data=dat))
```
The analyses show that there was an effect of distractors, F(2,42) = 2.7, p < 0.08262. 
There was also an effect of type, F(1,42) =
459.42, p < 2e-16. 
There was also an interaction between distractors and type, F(2,42) = 7.84, p < 0.00128.
<!--
Create a line graph and a grouped bar graph to help us interpret
the results of the previous analyses. Include error bars in your
figures.
-->
To help me interpret the earlier analyses, I'll create line and grouped bar graphs for the data I analyzed. But first I need to summarize the data.
```{r}
temp<-dat%>%group_by(distractors,type)%>%
  summarize(means=mean(rt),
            sems=sd(rt)/sqrt(length(n)))
```
Now I can create the figures.
```{r}
f<-ggplot(temp, aes(x=distractors,
                    y=means,
                    group=type,
                    color=type))+
  geom_line(size=1)+
  geom_point(size=2)+
  scale_color_manual(values=c("darkgreen","red"),
                     name="Type",
                     breaks=c("conjunction","feature"),
                     labels=c("conjunction", "feature"))+
  geom_errorbar(aes(ymax=means+sems, ymin=means-sems),width=.2)+
  ggtitle("Serial distractors With and Without type")+
  labs(x="List distractors",y="rt Recalled")+
  theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
  theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
  theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
  theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
  theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
  coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),
                         max(temp$means)+2*max(temp$sems)))+
  theme(panel.border=element_blank(),axis.line=element_line())+
  theme(panel.grid.major.x=element_blank())+
  theme(panel.grid.major.y=element_line(color="darkgrey"))+
  theme(panel.grid.minor.y=element_blank())+
  theme(legend.position=c(.4,.76))+
  theme(legend.background=element_blank())+
  theme(legend.background=element_rect(color="black"))+
  theme(legend.title=element_blank())+
  theme(legend.title=element_text(size=12))+
  theme(legend.title.align=.5)+
  theme(legend.text=element_text(size=10,face="bold"))
f

f<-ggplot(temp, aes(x=distractors,
                    y=means,
                    fill=type))+
  geom_bar(stat="identity",position=position_dodge())+
  scale_fill_manual(values=c("darkgreen","red"),
                     name="Type",
                     breaks=c("conjunction","feature"),
                     labels=c("conjunction", "feature"))+
  geom_errorbar(aes(ymax=means+sems,
                    ymin=means-sems),
                width=.2,
                position=position_dodge(.9))+
  ggtitle("Serial Distractors With and Without Type")+
  labs(x="List Distractors",y="rt Recalled")+
  theme(plot.title=element_text(size=15,face="bold",vjust=.5))+
  theme(axis.title.x=element_text(size=12,face="bold",vjust=-.25))+
  theme(axis.title.y=element_text(size=12,face="bold",vjust=1))+
  theme(axis.text.x=element_text(size=10,face="bold",color="black"))+
  theme(axis.text.y=element_text(size=10,face="bold",color="black"))+
  coord_cartesian(ylim=c(min(temp$means)-2*max(temp$sems),
                         max(temp$means)+2*max(temp$sems)))+
  theme(panel.border=element_blank(),axis.line=element_line())+
  theme(panel.grid.major.x=element_blank())+
  theme(panel.grid.major.y=element_line(color="darkgrey"))+
  theme(panel.grid.minor.y=element_blank())+
  theme(legend.position=c(.4,.76))+
  theme(legend.background=element_blank())+
  theme(legend.background=element_rect(color="black"))+
  theme(legend.title=element_blank())+
  theme(legend.title=element_text(size=12))+
  theme(legend.title.align=.5)+
  theme(legend.text=element_text(size=10,face="bold"))
f
```

<!--
Interpret the statistical results in light of the figures.
-->
From the figures and earlier analyses we can see thatthat people generally do the best on the
words that occur later on the list and worst on the words that occur in the beginning of the list.
We can also see that in general participants performed worse when they had an intervening distracting task. 
Most importantly, the interaction reveals that although individuals
without intervening distracting tasks perform best on the latest and earlier list positions, those with the distractor tasks performed better on later positions than on earlier ones.

<!--
Perform a within-subjects two-way ANOVA examining for the effects
of and interactions between number of distractors and search type.
Tip: use subject as the subject's variable for this analysis.
Interpret the results of the analysis based on the statistical
results and your earlier figures.
-->
Here I'm performing a within-subjects two-way ANOVA to examine for the effects of and interactions between list distractors and
type.
```{r}
summary(aov(rt~distractors*type+
              Error(subject/(distractors*type)),
                    data=dat))
```
From the analyses and the figures we can see that generally people perform best for the initial and later list distractions, F(2,14) =
11.2, p < 0.00127. We can also see that people are generally more accurate to recall words when they don't have an intervening distractor tasks to complete, F(1,7) = 1626, p < 1.5e-09. Finally,
we can see that those without a distractor task perform best for the words at the beginning and end of the lists while, those with a
distractor task perform best for the initial words and worst for the ending words, F(2,14) = 32.1, p < 5.95e-06.

<!--
Finally conduct and interpret the results of a mixed ANOVA in which
number of distractors varies within subjects and the type of search
varies between subjects. Make sure to interpret your results. Tip:
use subject2 as your subject's variable for this analysis.
-->
Finally, I'll conduct a mixed ANOVA in which distractors varies within participants and type varies between participants.
```{r}
summary(aov(rt~distractors*type+
              Error(subject2/distractors),
            data=dat))
```
From our anlyses, we can see that individuals without distracting tasks performed better than those who had, F(1,14) = 182.4, p = 2.02e-09.
Additionally, participants generally performed better on the words at the beginning and ends of the lists, F(2,28) = 11, p < 3e-04.
Finally, we can see that distracted individuals performed best on the initial words only while individuals who weren't distracted performed well on items at the beginning and end of the lists,F(2,28) = 32.5, p < 4.98e-08.